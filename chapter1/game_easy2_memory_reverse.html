<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reverse Memory Game</title>
</head>
<style>
body {
    font-family: Arial, sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    background-color: #f0f0f0;
    margin: 0;
    padding: 20px;
    transition: background-color 1.2s;
}

.game-container {
    text-align: center;
}

.equation-section {
    margin: 20px 0;
    padding: 20px;
    border-radius: 10px;
    background-color: white;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

#equation {
    font-size: 24px;
    margin: 10px 0;
    font-weight: bold;
}

.answer-input {
    padding: 8px;
    font-size: 18px;
    margin: 0 10px;
    border: 2px solid #ddd;
    border-radius: 4px;
    width: 100px;
}

.container {
  display: flex;
  justify-content: center;
  align-items: center;
  margin-top: 2rem;
}

.instructions-container {
  flex: 0 0 300px;
  margin-right: 2rem;
}

.instructions {
  background-color: #f8f8f8;
  border-radius: 10px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  padding: 2rem;
  transition: background-color 0.3s ease;
}

.instructions:hover {
  background-color: #f2f2f2;
}

.instructions h2 {
  font-size: 1.8rem;
  color: #333;
  margin-bottom: 1.5rem;
  text-align: center;
  font-weight: 600;
}

.instructions ol {
  margin: 0;
  padding-left: 1.8rem;
  color: #333333;
  font-size: 1.1rem;
  list-style-type: none;
}

.instructions li {
  margin: 0.8rem 0;
  line-height: 1.5;
  counter-increment: item;
}

.instructions li:before {
  content: counter(item) ". ";
  color: #4428e2;
  font-weight: bold;
  margin-right: 0.5rem;
}

.instructions li span {
  color: #333;
}

.instructions li strong {
  color: #4CAF50;
  font-weight: 600;
}
.submit-btn {
    padding: 8px 20px;
    font-size: 18px;
    cursor: pointer;
    background-color: #4CAF50;
    color: white;
    border: none;
    border-radius: 4px;
    transition: background-color 0.3s;
}

.submit-btn:hover {
    background-color: #45a049;
}

.memory-board {
    display: grid;
    grid-template-columns: repeat(4, 100px);
    gap: 10px;
    margin-top: 20px;
    perspective: 1000px;
}

.card {
    width: 100px;
    height: 100px;
    position: relative;
    transform-style: preserve-3d;
    transition: transform 0.6s;
    cursor: pointer;
}

.card.flipped {
    transform: rotateY(180deg);
}

.card-face {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    border-radius: 5px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

.card-front {
    background-color: #2196F3;
    transform: rotateY(180deg);
    color: white;
}

.card-back {
    background-color: #ddd;
    background-image: linear-gradient(45deg, #ccc 25%, transparent 25%),
                      linear-gradient(-45deg, #ccc 25%, transparent 25%),
                      linear-gradient(45deg, transparent 75%, #ccc 75%),
                      linear-gradient(-45deg, transparent 75%, #ccc 75%);
    background-size: 20px 20px;
    background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
}

.scores {
    display: flex;
    justify-content: space-around;
    width: 100%;
    max-width: 500px;
    margin: 20px 0;
}

.player-score {
    padding: 10px 20px;
    border-radius: 5px;
    font-size: 18px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

#leftScore {
    background-color: #8B4513;
    color: white;
}

#rightScore {
    background-color: #FFD700;
}

.hint {
    margin-top: 10px;
    color: #666;
    font-style: italic;
}

@keyframes matched {
    0% { transform: rotateY(180deg) scale(1); }
    50% { transform: rotateY(180deg) scale(1.1); }
    100% { transform: rotateY(180deg) scale(1); }
}

.card.matched .card-front {
    animation: matched 0.6s ease-in-out;
    background-color: #4CAF50;
}

.card:hover {
    transition: transform 0.6s;
}

</style>
<body>
<div class="container">
  <div class="instructions-container">
    <div class="instructions">
      <h2>วิธีการเล่นเกม Memory</h2>
      <ol>
        <li><strong>จับคู่การ์ด</strong>: หากการ์ดที่เปิดออกมามีเลขเดียวกัน ผู้เล่นจะมีโอกาสได้แก้สมการ
</li>
        <li><strong>แก้สมการให้ถูกต้อง</strong>แก้สมการทางคณิตศาสตร์ เมื่อแก้สมการถูกต้อง ผู้เล่นจะได้รับ 1 คะแนน</li>
        <li><strong>แก้สมการให้ผิด</strong>: หากผู้เล่นคนแรกแก้สมการไม่ถูก อีกฝ่ายจะมีโอกาสได้แก้ และมีโอกาสได้รับคะแนน</li>
        <li><strong>ไม่มีใครตอบถูก</strong>: หากไม่มีคนตอบถูกในสมการ จะถือว่าเป็น โมฆะ</li>
        <li><strong>สะสมคะแนน</strong>: ผู้เล่นที่สามารถแก้สมาการได้มากที่สุด จะเป็นผู้ชนะ</li>
      </ol>
    </div>
  </div>
  <div class="game-container">
    <div class="scores">
      <div id="leftScore" class="player-score">ผู้เล่น 1: 0</div>
      <div id="rightScore" class="player-score">ผู้เล่น 2: 0</div>
    </div>
    <div class="equation-section">
      <div id="equation"></div>
      <input type="number" class="answer-input" id="answer" placeholder="คำตอบ">
      <button class="submit-btn" onclick="checkAnswer()">ตอบ</button>
      <div id="hint" class="hint"></div>
    </div>
    <div class="memory-board" id="board"></div>
  </div>
</div>

<script>
let currentPlayer = 'left';
let scores = { left: 0, right: 0 };
let firstCard = null;
let secondCard = null;
let lockBoard = false;
let totalPairs = 8;
let currentEquation = null;
let waitingForAnswer = false;
let currentMatchingPlayer = null;

// สร้างคู่ตัวเลขสำหรับเกม memory
const numbers = Array.from({length: totalPairs}, (_, i) => i + 1);
const cards = [...numbers, ...numbers];
let shuffledCards = [];

// ฟังก์ชันสุ่มตัวเลข
function getRandomInt(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
}

// ฟังก์ชันสุ่มสมการที่มีคำตอบเป็นจำนวนเต็มบวกเท่านั้น
function generateEquation() {
    const equationType = getRandomInt(1, 5);
    // เปลี่ยนช่วงของ x เป็น 1-10 เพื่อให้แน่ใจว่าได้คำตอบเป็นบวก
    const x = getRandomInt(1, 10);
    let equation, answer;

    switch (equationType) {
        case 1:
            // ax + b = c -> คำตอบจะเป็นบวกเสมอเพราะ x เป็นบวก
            const a1 = getRandomInt(1, 5);
            const b1 = getRandomInt(0, 10);
            equation = `${a1}x + ${b1} = ${a1 * x + b1}`;
            answer = x;
            break;
        case 2:
            // ax = bx + c -> เลือก b และ c ที่ทำให้คำตอบเป็นบวก
            const a2 = getRandomInt(2, 6);
            const b2 = getRandomInt(1, a2 - 1); // ให้ a2 > b2 เสมอ
            const c2 = (a2 - b2) * x; // ทำให้แน่ใจว่า c2 เป็นบวก
            equation = `${a2}x = ${b2}x + ${c2}`;
            answer = x;
            break;
        case 3:
            // (ax + b)/c = d -> เลือกตัวเลขที่ทำให้คำตอบเป็นบวก
            const c3 = getRandomInt(2, 4);
            const a3 = getRandomInt(1, 5) * c3; // ทำให้หารลงตัว
            const b3 = getRandomInt(0, 10) * c3;
            const d3 = (a3 * x + b3) / c3;
            equation = `(${a3}x + ${b3})/${c3} = ${d3}`;
            answer = x;
            break;
        case 4:
            // ax + b = cx + d -> เลือกค่าที่ทำให้คำตอบเป็นบวก
            const a4 = getRandomInt(2, 6);
            const c4 = getRandomInt(1, a4 - 1); // ให้ a4 > c4 เสมอ
            const b4 = getRandomInt(1, 10);
            const d4 = b4 - (a4 - c4) * x;
            equation = `${a4}x + ${b4} = ${c4}x + ${d4}`;
            answer = x;
            break;
        case 5:
            // a(x + b) = c -> เลือกค่าที่ทำให้คำตอบเป็นบวก
            const a5 = getRandomInt(2, 5);
            const b5 = getRandomInt(1, 5);
            const c5 = a5 * (x + b5);
            equation = `${a5}(x + ${b5}) = ${c5}`;
            answer = x;
            break;
    }

    return { equation, answer };
}


// ฟังก์ชันตรวจสอบคำตอบ - ปรับปรุงใหม่
function checkAnswer() {
    if (!waitingForAnswer) return;

    const userAnswer = parseInt(document.getElementById('answer').value);
    const hintElement = document.getElementById('hint');

    if (userAnswer === currentEquation.answer) {
        // ตอบถูก - ให้คะแนนผู้เล่นที่ตอบถูก
        scores[currentPlayer]++;
        document.getElementById(`${currentPlayer}Score`).textContent = 
            `ผู้เล่น ${currentPlayer === 'left' ? '1' : '2'}: ${scores[currentPlayer]}`;
        
        hintElement.innerHTML = `<span style="color: green;">ยินดีด้วย! ผู้เล่น ${currentPlayer === 'left' ? '1' : '2'} ตอบถูกและได้ 1 คะแนน!</span>`;
        
        // ทำเครื่องหมายว่าการ์ดจับคู่ได้แล้ว
        firstCard.classList.add('matched');
        secondCard.classList.add('matched');
        disableCards();
        
        waitingForAnswer = false;
        resetForNextTurn();
        
        // เช็คว่าจบเกมหรือยัง
        checkGameOver();
    } else {
        hintElement.innerHTML = `<span style="color: red;">เสียใจด้วย! ผู้เล่น ${currentPlayer === 'left' ? '1' : '2'} ตอบผิด</span>`;
        
        // สลับผู้เล่นเพื่อให้อีกฝ่ายได้ลองตอบ
        if (currentPlayer === currentMatchingPlayer) {
            currentPlayer = currentPlayer === 'left' ? 'right' : 'left';
            document.body.style.backgroundColor = currentPlayer === 'left' ? '#8B4513' : '#FFD700';
            hintElement.innerHTML += `<br><span style="color: blue;">ผู้เล่น ${currentPlayer === 'left' ? '1' : '2'} มีโอกาสตอบ</span>`;
        } else {
            // ถ้าทั้งสองฝ่ายตอบผิด
            setTimeout(() => {
                unflipCards();
                waitingForAnswer = false;
                resetForNextTurn();
            }, 1000);
        }
    }
    
    document.getElementById('answer').value = '';
}

// ฟังก์ชันสร้างการ์ด (คงเดิม)
function createBoard() {
    shuffledCards = [...cards].sort(() => Math.random() - 0.5);
    const board = document.getElementById('board');
    board.innerHTML = '';
    
    shuffledCards.forEach((number, index) => {
        const card = document.createElement('div');
        card.classList.add('card');
        card.setAttribute('data-index', index);
        card.setAttribute('data-value', number);
        
        const cardFront = document.createElement('div');
        cardFront.classList.add('card-face', 'card-front');
        cardFront.textContent = number;
        
        const cardBack = document.createElement('div');
        cardBack.classList.add('card-face', 'card-back');
        
        card.appendChild(cardFront);
        card.appendChild(cardBack);
        card.addEventListener('click', flipCard);
        board.appendChild(card);
    });
}

// ฟังก์ชันพลิกการ์ด
function flipCard() {
    if (lockBoard || waitingForAnswer || this === firstCard || this.classList.contains('matched')) return;
    
    this.classList.add('flipped');

    if (!firstCard) {
        firstCard = this;
        return;
    }

    secondCard = this;
    checkForMatch();
}

// ฟังก์ชันตรวจสอบการ์ดที่จับคู่
function checkForMatch() {
    const isMatch = firstCard.getAttribute('data-value') === secondCard.getAttribute('data-value');

    if (isMatch) {
        // เก็บผู้เล่นที่จับคู่ได้
        currentMatchingPlayer = currentPlayer;
        
        // สร้างโจทย์ใหม่
        currentEquation = generateEquation();
        document.getElementById('equation').textContent = `โจทย์: ${currentEquation.equation}`;
        
        // เริ่มรอคำตอบ
        waitingForAnswer = true;
        
        const hintElement = document.getElementById('hint');
        hintElement.innerHTML = `<span style="color: blue;">ผู้เล่น ${currentPlayer === 'left' ? '1' : '2'} จับคู่ได้! กรุณาตอบคำถาม</span>`;
    } else {
        unflipCards();
        // สลับผู้เล่นเมื่อจับคู่ไม่ได้
        currentPlayer = currentPlayer === 'left' ? 'right' : 'left';
        document.body.style.backgroundColor = currentPlayer === 'left' ? '#8B4513' : '#FFD700';
    }
}

// ฟังก์ชันปิดการ์ดที่จับคู่แล้ว
function disableCards() {
    firstCard.removeEventListener('click', flipCard);
    secondCard.removeEventListener('click', flipCard);
    resetBoard();
}

// ฟังก์ชันพลิกการ์ดกลับ
function unflipCards() {
    lockBoard = true;
    setTimeout(() => {
        firstCard.classList.remove('flipped');
        secondCard.classList.remove('flipped');
        resetBoard();
    }, 1000);
}

// รีเซ็ตตัวแปรการ์ด
function resetBoard() {
    [firstCard, secondCard] = [null, null];
    lockBoard = false;
}

// รีเซ็ตสำหรับรอบต่อไป
function resetForNextTurn() {
    resetBoard();
    currentPlayer = currentMatchingPlayer === 'left' ? 'right' : 'left';
    document.body.style.backgroundColor = currentPlayer === 'left' ? '#8B4513' : '#FFD700';
    currentMatchingPlayer = null;
    document.getElementById('equation').textContent = 'จับคู่การ์ดเพื่อรับโจทย์';
}

// ฟังก์ชันตรวจสอบการจบเกม
function checkGameOver() {
    const totalMatched = document.querySelectorAll('.matched').length / 2;
    if (totalMatched === totalPairs) {
        declareWinner();
    }
}

// ฟังก์ชันประกาศผู้ชนะ
function declareWinner() {
    const winner = scores.left > scores.right ? 'ผู้เล่น 1' : 
                  scores.left < scores.right ? 'ผู้เล่น 2' : 
                  'เสมอ';
    const message = winner === 'เสมอ' ? 
                   'จบเกม! ผลเสมอกัน!' :
                   `จบเกม! ${winner} ชนะ ด้วยคะแนน ${Math.max(scores.left, scores.right)} คะแนน!`;
    
    setTimeout(() => {
        alert(message);
        resetGame();
    }, 500);
}

// ฟังก์ชันรีเซ็ตเกม
function resetGame() {
    scores = { left: 0, right: 0 };
    document.getElementById('leftScore').textContent = 'ผู้เล่น 1: 0';
    document.getElementById('rightScore').textContent = 'ผู้เล่น 2: 0';
    waitingForAnswer = false;
    currentMatchingPlayer = null;
    document.getElementById('equation').textContent = 'จับคู่การ์ดเพื่อรับโจทย์';
    document.getElementById('hint').textContent = '';
    createBoard();
    currentPlayer = 'left';
    document.body.style.backgroundColor = '#8B4513';
}

// เริ่มเกม
createBoard();
document.getElementById('equation').textContent = 'จับคู่การ์ดเพื่อรับโจทย์';
document.body.style.backgroundColor = '#8B4513';
</script>
</body>
</html>